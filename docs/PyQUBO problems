# Constraints

The idea is to use the formulation sended in the deriverable. 
The main aspects are that, instead of work with an adyacency matrix for each line, where the elements x_{ij}^{l}=1 if the line l goes from i to j, we change to a vector variable y_{k}^{l} of N^2 components.
The 5 formulated constraints in the document are:

1) fixed number (p) of stops per line
2) For each node i and line l, at most one edge can departure from i to any other node j (use of slack variable s to mimic inequality)
3) For each node j and line l, at most one edge can arrive to j from any other node i (use of slack variable s to mimic inequality)
4) For each line l, there must be a closed path of lenght p (use of matrix power)
5) For each line l, no paths of lenght less than p can be (use of matrix power)

There is a 6) constraint regarding the conection between lines. It can be also implemented with matrix power.

## Change of cosntraints

In order of getting rid of the matrix power operations and improve performance times in the construction of the QUBO model I tried two more constraints in subsitution of constraints 4, 5 and 6. There are:

7) For each line l, each node i and each node j, if the is an edge from i to j, there must be an edge from j to another edge k (Continuity of lines)
8) For each node i, there must be at least one line in which an edge from i to another node j exists (use of slack variable. Every node is visited at least once)

These two extra conditions in conjunction to 1, 2 and 3, should provide a valid solution. 
However, at the moment, as the constraint of closed paths is not explicit (it is derived from the added action of the others), it is normally not fulffiled.
